document.querySelector('form').addEventListener('submit', async (e) => {
  e.preventDefault();

  const nome = document.querySelector('#nome').value.trim();
  const sobrenome = document.querySelector('#sobrenome').value.trim();
  const email = document.querySelector('#email').value.trim();
  const senha = document.querySelector('#senha').value;

  // Monta data de nascimento a partir dos selects
  const dia = document.querySelector('select[name="Dia"]').value.replace('dia-', '');
  const mes = document.querySelector('select[name="mes"]').value.replace('mes-', '');
  const ano = document.querySelector('select[name="ano"]').value.replace('ano-', '');
  const data_nascimento = `${ano}-${mes.padStart(2, '0')}-${dia.padStart(2, '0')}`;

  // Pega o gÃªnero selecionado
  const genero = document.querySelector('input[name="genero"]:checked')?.parentElement.innerText.trim();

  const dados = { nome, sobrenome, email, senha, data_nascimento, genero };

  try {
    const resposta = await fetch('http://localhost:3000/api/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(dados),
    });

    const texto = await resposta.text();
    alert(texto);
    if (resposta.ok) window.location.href = 'login.html';
  } catch (erro) {
    console.error('Erro ao cadastrar:', erro);
    alert('Erro ao cadastrar. Tente novamente.');
  }
});
